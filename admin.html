<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Admin | Sorteos del Norte GR</title>
<style>
body {
  font-family: Arial;
  background: #111;
  color: white;
  padding: 20px;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}

th, td {
  border: 1px solid #555;
  padding: 8px;
  text-align: center;
}

button {
  padding: 8px;
  margin: 5px;
  background: #1fa64a;
  border: none;
  cursor: pointer;
}
</style>
</head>

<body>

<h1>Panel Administrador</h1>

<div id="login">
  <input id="pass" type="password" placeholder="Contraseña">
  <button onclick="entrar()">Entrar</button>
</div>

<div id="panel" style="display:none">
  <button onclick="exportar()">Exportar Excel</button>
  <button onclick="borrar()">Borrar todo</button>

  <table>
    <thead>
      <tr>
        <th>Boleto</th>
        <th>Nombre</th>
        <th>Teléfono</th>
      </tr>
    </thead>
    <tbody id="tabla"></tbody>
  </table>
</div>

<script>
const PASSWORD = "admin123";

function entrar() {
  if (document.getElementById("pass").value === PASSWORD) {
    document.getElementById("login").style.display = "none";
    document.getElementById("panel").style.display = "block";
    cargar();
  } else {
    alert("Contraseña incorrecta");
  }
}

function cargar() {
  let vendidos = JSON.parse(localStorage.getItem("vendidos")) || {};
  let tabla = document.getElementById("tabla");
  tabla.innerHTML = "";

  for (let num in vendidos) {
    tabla.innerHTML += `
      <tr>
        <td>${num}</td>
        <td>${vendidos[num].nombre}</td>
        <td>${vendidos[num].telefono}</td>
      </tr>
    `;
  }
}

function borrar() {
  if (confirm("¿Seguro que quieres borrar todo?")) {
    localStorage.removeItem("vendidos");
    location.reload();
  }
}

function exportar() {
  let vendidos = JSON.parse(localStorage.getItem("vendidos")) || {};
  let csv = "Boleto,Nombre,Telefono\n";

  for (let n in vendidos) {
    csv += ${n},${vendidos[n].nombre},${vendidos[n].telefono}\n;
  }

  let blob = new Blob([csv], { type: "text/csv" });
  let url = URL.createObjectURL(blob);
  let a = document.createElement("a");
  a.href = url;
  a.download = "rifa_sorteos_del_norte_gr.csv";
  a.click();
}
</script>

</body>
</html>